extends ../layout/index.pug

block append stylesheets
  link(rel='stylesheet' href='/login/index.css')

block content
  form#login.login-wrapper.columns(
    action='/login/authenticate'
    method='post'
    v-on:submit='onSubmit($event)'
  )
    .column.is-8.is-hidden-mobile.hero-banner
      section.hero.is-fullheight.is-dark
    .column.is-4
      section.hero.is-fullheight
        .hero-heading
          .section.branding
            img(src='https://scontent.fcgh12-1.fna.fbcdn.net/v/t1.0-9/18485637_463933077287175_2318472613500243303_n.png?oh=62ad84d556389be5990a8990b75b7370&oe=59C447BE' alt='Beta logo' height='50px')
            .brand-name BETA
        .hero-body
          .container
            .columns
              .column.is-8.is-offset-2
                h1.avatar.has-text-centered.section
                  img(src='https://scontent.fcgh12-1.fna.fbcdn.net/v/t1.0-9/18485498_463912997289183_6766375779007506020_n.png?oh=d70fe6affd9b823f09c64546fb253f44&oe=59CCAF85')
                .login-form
                  p.control.has-icon.has-icon-right
                    input.input.email-input(
                      type='text'
                      name='email'
                      placeholder='bot@beta.com'
                      autofocus
                      v-model='email'
                      v-bind:class="{ 'is-danger': !validEmail && emailDirty, 'is-success': email && emailDirty }"
                      v-on:focus='onEmailFocus'
                    )
                    span.icon.user
                      i.fa.fa-user
                  p.help.is-danger(v-if='!email && emailDirty') Campo obrigatório
                  p.help.is-danger(v-if='!validEmail && email') Formato de email inválido

                  p.control.has-icon.has-icon-right
                    input.input.password-input(
                      type='password'
                      name='password'
                      placeholder='••••••••'
                      v-model='password'
                      v-bind:class="{ 'is-danger': !password && passwordDirty, 'is-success': password && passwordDirty }"
                      v-on:focus='onPasswordFocus'
                    )
                    span.icon.user
                      i.fa.fa-lock
                  p.help.is-danger(v-if='!password && passwordDirty') Campo obrigatório

                  p.control.login
                    button.button.is-success.is-outlined.is-large.is-fullwidth Login

  script(type='text/javascript').
    new Vue({
      el: '#login',
      data: {
        email: undefined,
        emailDirty: false,
        password: undefined,
        passwordDirty: false
      },
      computed: {
        validEmail: function () {
          return /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(this.email)
        }
      },
      methods: {
        onEmailFocus: function () { this.emailDirty = true },
        onPasswordFocus: function () { this.passwordDirty = true },
        onSubmit: function (event) {
          var validation = this.validEmail && this.password
          if (!validation) event.preventDefault()
        }
      }
    })
